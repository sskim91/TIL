#!/bin/bash
# ============================================================
# post-merge: pull 후 전체 파일 Obsidian에 동기화
# ============================================================
#
# ■ 언제 실행되나?
#   git pull (또는 git merge) 명령이 성공적으로 완료된 직후
#
# ■ 왜 전체 동기화인가?
#   다른 컴퓨터에서 커밋한 내용을 pull 받으면
#   post-commit hook은 안 돌아감 (커밋한 게 아니니까)
#   그래서 pull 후에는 전체 동기화 필요
#
# ■ 시나리오 예시
#   회사: 파일 10개 수정 → commit → post-commit(--diff) → 10개만 동기화
#   집:   git pull → post-merge → 전체 동기화
#
# ■ 플랫폼 제한
#   - macOS에서만 실행 (Obsidian iCloud 경로가 macOS 전용)
#   - Linux(Ubuntu 서버)에서는 건너뜀
#
# ============================================================

# macOS가 아니면 건너뜀
if [[ "$(uname -s)" != "Darwin" ]]; then
    exit 0
fi

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"

# 전체 동기화 (옵션 없음)
python3 "$SCRIPT_DIR/sync-to-obsidian.py"
